/* empty css              *//* empty css              */import{I as S,C as B,N as C}from"./index-Ng53t6M2.js";import{Y as N,p as w,h as M,G as V,Z as I,q as j,f as u,$ as R,w as k,a0 as z,o as F,s as U,b as i,H as A,a1 as L,B as H,_ as Y,c as b,a2 as p,g as v,F as q,r as D,a3 as G,a4 as K,t as Z}from"./index-Js5mjqji.js";import{u as J}from"./use-expose-ss1KZ95K.js";import{i as O,L as Q}from"./index-Ccn0SgPu.js";const W=Symbol(),X=()=>N(W,null),[$,c,ee]=j("list"),ae={error:Boolean,offset:I(300),loading:Boolean,finished:Boolean,errorText:String,direction:V("down"),loadingText:String,finishedText:String,immediateCheck:M};var te=w({name:$,props:ae,emits:["load","update:error","update:loading"],setup(e,{emit:s,slots:n}){const t=u(e.loading),f=u(),h=u(),d=X(),g=R(f),r=()=>{A(()=>{if(t.value||e.finished||e.error||(d==null?void 0:d.value)===!1)return;const{offset:a,direction:m}=e,l=L(g);if(!l.height||O(f))return;let x=!1;const T=L(h);m==="up"?x=l.top-T.top<=a:x=T.bottom-l.bottom<=a,x&&(t.value=!0,s("update:loading",!0),s("load"))})},_=()=>{if(e.finished){const a=n.finished?n.finished():e.finishedText;if(a)return i("div",{class:c("finished-text")},[a])}},o=()=>{s("update:error",!1),r()},P=()=>{if(e.error){const a=n.error?n.error():e.errorText;if(a)return i("div",{role:"button",class:c("error-text"),tabindex:0,onClick:o},[a])}},E=()=>{if(t.value&&!e.finished)return i("div",{class:c("loading")},[n.loading?n.loading():i(Q,{class:c("loading-icon")},{default:()=>[e.loadingText||ee("loading")]})])};return k(()=>[e.loading,e.finished,e.error],r),d&&k(d,a=>{a&&r()}),z(()=>{t.value=e.loading}),F(()=>{e.immediateCheck&&r()}),J({check:r}),U("scroll",r,{target:g,passive:!0}),()=>{var a;const m=(a=n.default)==null?void 0:a.call(n),l=i("div",{ref:h,class:c("placeholder")},null);return i("div",{ref:f,role:"feed",class:c(),"aria-busy":t.value},[e.direction==="down"?m:l,E(),_(),P(),e.direction==="up"?m:l])}}});const y=H(te),ne={components:{VanNavBar:C,VanList:y,VanCell:B,VanImage:S},setup(){const e=u([{id:1,name:"张三",avatar:"https://img01.yzcdn.cn/vant/cat.jpeg",lastMessage:"明天一起吃饭吗？",time:"10:30",unread:2},{id:2,name:"李四",avatar:"https://img01.yzcdn.cn/vant/dog.jpeg",lastMessage:"项目文件已经发送给你了",time:"昨天",unread:1},{id:3,name:"王五",avatar:"https://img01.yzcdn.cn/vant/rabbit.jpeg",lastMessage:"好的，没问题",time:"周三",unread:0}]),s=u(!1),n=u(!1);return{messages:e,loading:s,finished:n,onLoad:()=>{setTimeout(()=>{s.value=!1},1e3)}}}},oe={class:"message-page"},se={key:0,class:"unread-badge"};function ie(e,s,n,t,f,h){const d=C,g=S,r=B,_=y;return v(),b("div",oe,[i(d,{title:"消息",fixed:""}),i(_,{loading:t.loading,"onUpdate:loading":s[0]||(s[0]=o=>t.loading=o),finished:t.finished,"finished-text":"没有更多消息",onLoad:t.onLoad},{default:p(()=>[(v(!0),b(q,null,D(t.messages,o=>(v(),G(r,{key:o.id,title:o.name,value:o.lastMessage,label:o.time,class:"message-item"},{icon:p(()=>[i(g,{src:o.avatar,round:"",class:"avatar"},null,8,["src"])]),extra:p(()=>[o.unread>0?(v(),b("div",se,Z(o.unread),1)):K("",!0)]),_:2},1032,["title","value","label"]))),128))]),_:1},8,["loading","finished","onLoad"])])}const ge=Y(ne,[["render",ie],["__scopeId","data-v-cbdfbd46"]]);export{ge as default};
